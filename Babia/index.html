<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>BabiaXR - Tutorial</title>
    
    <!-- import the webpage's stylesheet -->
    <link rel="stylesheet" href="/style.css">

    <!-- import the webpage's javascript file -->
    <script src="/script.js" defer></script>
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-babia-components/dist/aframe-babia-components.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.0.0/dist/aframe-environment-component.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@v6.1.0/dist/aframe-extras.min.js"></script>
    <script src="https://supereggbert.github.io/aframe-htmlembed-component/dist/build.js"></script>
    <script src="https://unpkg.com/super-hands/dist/super-hands.min.js"></script>

    
    
    <script>
      AFRAME.registerComponent('change-color', {
        schema: {
          color: {default: "red"}
        },
        
        init: function () {
          var data = this.data;
          var el = this.el;
          this.el.addEventListener('click', function () {
            el.setAttribute('color', data.color);
          });
        }
      });

      // Nombre del archivo json 
      AFRAME.registerComponent('visualizer', {
        schema: {},
        
        init: function () {
          var el = this.el;

          // Obtener elemento 'babia-queryjson'
          var value = el.getAttribute('babia-queryjson').url;

          // Obtener referencia de entidad por id
          var entity = document.querySelector('#url');

          // Agregar componente a esa entidad
          entity.setAttribute('value', value);
        }
      });

    </script>

  </head>  
  <body>
    <a-scene>
        <!-- Environment -->
        <a-entity environment ></a-entity>
        <!-- Light -->
        <a-light type="point" intensity="1" position="-10 20 30"></a-light>
      
        <!-- Pie -->
        <a-entity babia-pie='key:model; size: doors; legend: true; palette: sunset;
          data:[{"model": "leon", "motor": "electric", "color": "red", "doors": 5, "sales": 10},
                {"model": "ibiza", "motor": "electric", "color": "white", "doors": 3, "sales": 15},
                {"model": "cordoba", "motor": "diesel", "color": "black", "doors": 5, "sales": 3},
                {"model": "toledo", "motor": "diesel", "color": "white", "doors": 5, "sales": 18},
                {"model": "altea", "motor": "diesel", "color": "red", "doors": 5, "sales": 4},
                {"model": "arosa", "motor": "electric", "color": "red", "doors": 3, "sales": 12},
                {"model": "alhambra", "motor": "diesel", "color": "white", "doors": 5, "sales": 5},
                {"model": "600", "motor": "gasoline", "color": "yellow", "doors": 3, "sales": 20},
                {"model": "127", "motor": "gasoline", "color": "white", "doors": 5, "sales": 2},
                {"model": "panda", "motor": "gasoline", "color": "black", "doors": 3, "sales": 13}]'
                position="-20 2 0" rotation="90 0 0" scale="2 2 2"></a-entity>

        <!-- Data -->      
        <a-entity id="data" babia-queryjson="url: ./data.json" visualizer>
        
        <!-- Nombre del JSON -->
        <a-entity position="-5 12 0" scale="6 6 6" color="blue">
          <a-text id ="url" value></a-text>
        </a-entity>  
          
                
        <!-- 3DBars-->
        <!-- <a-entity id="graph2" babia-barsmap="from: data; legend: true; palette: ubuntu;
                  x_axis: model; z_axis: color; height: sales" 
                  position="-20 0 0" scale="1 1 1"></a-entity>
        -->

        <!-- NUEVO -->

        <a-entity position="-5 12 0">
          <a-box color="green" position="-4 -2 -5" rotation="0 45 45" scale="2 2 2" change-color></a-box>
        </a-entity>

        <!-- Camera -->
        <a-entity movement-controls="fly: true" position="0 5 20">
            <a-entity camera position="0 0 0" look-controls></a-entity>
            <a-entity cursor="rayOrigin:mouse"></a-entity>
            <a-entity laser-controls="hand: right"></a-entity>
        </a-entity>
    </a-scene>

    <!-- include the Glitch button to show what the webpage is about and
          to make it easier for folks to view source and remix -->
    <div class="glitchButton" style="position:fixed;top:20px;right:20px;"></div>
    <script src="https://button.glitch.me/button.js" defer></script>
  </body>
</html>